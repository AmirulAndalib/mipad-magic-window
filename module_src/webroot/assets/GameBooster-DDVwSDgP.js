import{A as ru,B as su,C as iu,f as N,k as $,g as f,d as Z,D as j,r as E,E as q,F as J,h as X,G as pu,q as du,i as uu,j as eu,e as p,H as Fu,I as cu,J as Eu,t as u,b as l,v as o,l as r,K as Y,L as tu,m as au,p as ou,M as gu,N as mu,O as vu,P as Bu,n as P,c as Cu,Q as I,R as Au,S as W,T as fu,U as Du,V as _u,W as yu,X as H,Y as bu,Z as ku}from"./index-DmMdYncT.js";function h(G,B){var x={};return B=ru(B),su(G,function(s,C,y){iu(x,B(s,C,y),s)}),x}function wu(G,B){return N(),$("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[f("path",{"fill-rule":"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z","clip-rule":"evenodd"})])}const Gu=Z({__name:"GameBoosterAppDrawer",props:{type:{},title:{}},emits:["submit"],setup(G,{expose:B,emit:x}){j(),E(null),E(null);const s=G,C=E(!1),y=q([{label:"自定义",value:"custom",type:"primary",color:{color:"rgba(155, 89, 182, 0.1)",borderColor:"rgba(155, 89, 182, 0.3)",textColor:"#9b59b6"}}]),g=h(y,a=>a.value),O=J(),S=h(O,a=>a.value),m=X();pu(),du();const z=uu(()=>({theme:m.isDarkMode?au:ou})),{message:_,modal:R}=eu(["message","modal"],{configProviderProps:z});let M,T;const b=E({openDrawer:a=>new Promise((e,c)=>{if(s.type==="update"&&!a){c(new Error("更新模式下必须传入初始化参数")),_.error("初始化参数不能为空");return}s.type==="update"&&(w.value=(a==null?void 0:a.packageName)||"",k.value=(a==null?void 0:a.appName)||"",a!=null&&a.gameGravity&&(A.value=S[a.gameGravity]),a!=null&&a.gameRatio&&(g[a.gameRatio]?(d.value=g[a.gameRatio],v.value=a.gameRatio):(d.value=g.custom,v.value=a.gameRatio))),M=e,T=c,C.value=!0}),closeDrawer:()=>{C.value=!1,T("Drawer closed without submission")}}),k=E(""),w=E(""),A=E(O[0]),d=E(y[0]),v=E(""),t=(a,e)=>{if(e.value==="custom"&&!m.ABTestInfo.GAME_BOOSTER_CUSTOM_RATIO){R.create({title:"无使用权限",type:"warning",preset:"dialog",content:()=>u("div",null,[u("p",null,[o("自定义游戏比例存在使用风险，如果配置了不恰当的自定义游戏比例，可能会触发部分游戏风控导致游戏账号被封！")]),u("p",null,[o("如仍然坚持使用自定义游戏比例，请通过做梦书的酷安动态获取自定义游戏比例的激活口令！(动态内容就有，无需私信，新功能不同口令也不相同)")])])});return}d.value=e,e.value==="custom"?v.value="":v.value=e.value},n=(a,e)=>{A.value=e},D=async()=>{if(!v.value){R.create({title:"游戏显示比例不能为空",type:"error",preset:"dialog",content:()=>u("p",null,[o("噫？游戏显示比例不能为空（敲")])});return}F.value=!0;const a=()=>{F.value=!1,C.value=!1},e=()=>{F.value=!1},c={appName:k.value,packageName:w.value,gameGravity:A.value.value,gameRatio:v.value,loadingCallback:e,closeCallback:a};R.create({title:"确认调整游戏显示布局吗？",type:"warning",preset:"dialog",content:()=>u("p",null,[o("调整后会改变游戏的显示比例，获得更大的游戏视野，但并非所有游戏都兼容游戏显示比例调整，且部分游戏可能会对游戏显示比例的修改作为风控管理，可能导致游戏账号被封禁，调整游戏显示布局前，即认可并了解这些须知。确定要继续吗？")]),positiveText:"确定调整",negativeText:"我再想想",onPositiveClick:async()=>{M(c),e(),a()},onNegativeClick(){e()},onMaskClick(){e()},onClose(){e()}})},F=E(!1);return B({openDrawer:b.value.openDrawer}),(a,e)=>{const c=p("n-input-group-label"),U=p("n-input"),V=p("n-input-group"),L=p("n-button"),K=p("n-dropdown"),Q=p("n-card"),lu=p("n-drawer-content"),nu=p("n-drawer");return N(),$(tu,null,[Fu(a.$slots,"default",cu(Eu({openDrawer:b.value.openDrawer}))),u(nu,{show:C.value,"onUpdate:show":e[7]||(e[7]=i=>C.value=i),"default-width":500,placement:"right"},{default:l(()=>[u(lu,{"body-content-class":"auto-ui-drawer-content","scrollbar-props":{trigger:"none"},title:s.title,closable:""},{footer:l(()=>[u(L,{type:"info",loading:F.value,"onUpdate:loading":e[5]||(e[5]=i=>F.value=i),onClick:e[6]||(e[6]=()=>D())},{default:l(()=>e[10]||(e[10]=[o(" 提交 ")])),_:1},8,["loading"])]),default:l(()=>[u(V,null,{default:l(()=>[u(c,{size:"large"},{default:l(()=>e[8]||(e[8]=[o("游戏名称")])),_:1}),u(U,{size:"large",value:k.value,"onUpdate:value":e[0]||(e[0]=i=>k.value=i),readonly:!0,placeholder:"请输入游戏名称"},null,8,["value"])]),_:1}),u(V,{class:"mt-5"},{default:l(()=>[u(c,{size:"large"},{default:l(()=>e[9]||(e[9]=[o("游戏包名")])),_:1}),u(U,{size:"large",value:w.value,"onUpdate:value":e[1]||(e[1]=i=>w.value=i),readonly:!0,placeholder:"请输入游戏包名"},null,8,["value"])]),_:1}),u(Q,{bordered:!1,title:"游戏显示比例",size:"small"},{default:l(()=>[u(K,{value:d.value,"onUpdate:value":e[2]||(e[2]=i=>d.value=i),size:"large",trigger:"click",options:r(y),onSelect:t},{default:l(()=>{var i;return[u(L,{block:"",type:d.value.type,color:(i=d.value.color)==null?void 0:i.textColor,dashed:""},{default:l(()=>[o(Y(d.value.label),1)]),_:1},8,["type","color"])]}),_:1},8,["value","options"]),u(V,{class:"mt-5"},{default:l(()=>[u(U,{type:"number",ref:"currentCustomGameRatioRef",readonly:d.value.value!=="custom",value:v.value,"onUpdate:value":e[3]||(e[3]=i=>v.value=i),placeholder:"请输入游戏显示比例"},null,8,["readonly","value"])]),_:1})]),_:1}),u(Q,{bordered:!1,title:"游戏显示位置",size:"small"},{default:l(()=>[u(K,{value:A.value,"onUpdate:value":e[4]||(e[4]=i=>A.value=i),size:"large",trigger:"click",options:r(O),onSelect:n},{default:l(()=>[u(L,{block:"",type:A.value.color,dashed:""},{default:l(()=>[o(Y(A.value.label),1)]),_:1},8,["type"])]),_:1},8,["value","options"])]),_:1})]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),xu={class:"autoui-view mb-10"},Su={class:"mt-5"},Ru={class:"mb-5 px-4 sm:px-0"},Mu={class:"mb-3 flex flex-wrap"},Ou={class:"flex flex-wrap"},Iu=Z({__name:"GameBooster",setup(G){const B=E(null),x=v(),s=X();gu();const C=uu(()=>({theme:s.isDarkMode?au:ou})),{message:y,modal:g,notification:O}=eu(["message","modal","notification"],{configProviderProps:C}),S=j(),m=mu(),z=q(),_=h(z,t=>t.value),R=J(),M=h(R,t=>t.value),T=vu(),b=E(null),k=async()=>{g.create({title:"获取手机/平板管家",type:"info",preset:"dialog",content:()=>u("div",null,[u("p",null,[o("由于小米调整了机型校验的规则，Hyper OS 2.0+ 还需要安装修改版的手机/平板管家才会生效~")]),u("p",null,[o("下载地址:https://caiyun.139.com/m/i?135Cdw6hrWd7c")])]),positiveText:"复制下载链接到剪切板",negativeText:"取消",onPositiveClick:()=>{navigator.clipboard.writeText("https://caiyun.139.com/m/i?135Cdw6hrWd7c")},onNegativeClick:()=>{}})},w=async(t,n)=>{if(!s.ABTestInfo.GAME_BOOSTER_RADIO_MANAGER){g.create({title:"内测说明",type:"warning",preset:"dialog",content:()=>u("p",null,[o("该功能尚处于测试阶段，预估最快2024-12-29后正式上线，可能存在较多不稳定性，需要有一定的玩机知识和问题解决能力，如需参与测试请通过做梦书的酷安动态获取新功能内测的激活口令！(动态内容就有，无需私信，新功能不同口令也不相同)")])});return}if(!T.isSupportGameMode.value){g.create({title:"未开启游戏显示布局",type:"error",preset:"dialog",content:()=>u("p",null,[o("未开启游戏显示布局，请先前往模块设置进行开启~")])});return}if(b.value){const[D,F]=await H(b.value.openDrawer({appName:t.app_name,packageName:t.package_name,gameRatio:t.game_ratio,gameGravity:t.game_gravity}));if(D)console.log("操作取消:",D);else if(F){m.loading=!0;const[a,e]=await H(bu(F.packageName,F.gameRatio,F.gameGravity));a&&(g.create({title:"更新设置失败",type:"error",preset:"dialog",content:()=>u("p",null,[o("发生异常错误，更新失败了QwQ，详细错误请查看错误日志~")])}),m.loading=!1),e&&(m.loading=!1,g.create({title:"更新设置成功",type:"success",preset:"dialog",content:()=>u("p",null,[o("好耶w，已经成功配置")," ",u("span",{class:`font-bold ${s.isDarkMode?"text-teal-400":"text-gray-600"}`},[F.appName])," ",o("的游戏显示布局了OwO~实际生效还需要重启")," ",u("span",{class:`font-bold ${s.isDarkMode?"text-teal-400":"text-gray-600"}`},[F.appName])," ",o("和")," ",u("span",{class:`font-bold ${s.isDarkMode?"text-teal-400":"text-gray-600"}`},[o("平板/手机管家")])," ",o("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){ku(t.package_name).then(async c=>{await m.initDefault(),g.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>u("p",null,[o("已经成功为你重启对应的作用域，请查看是否生效~")])})}).catch(c=>{g.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>u("p",null,[o("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}))}}},A=async()=>{await m.initDefault()},d=Bu({page:1,pageSize:10,showSizePicker:!0,onChange:t=>{d.page=t},onUpdatePageSize:t=>{d.pageSize=t,d.page=1}});function v(){return[{title:"游戏名称",minWidth:250,key:"name",render(t,n){return u("div",null,[t.app_name&&u("p",null,[t.app_name]),t.app_name&&u("p",null,[u("span",{class:{hidden:!t.app_name}},[o("(")]),t.package_name,u("span",{class:{hidden:!t.app_name}},[o(")")])])])}},{title:"游戏显示比例",minWidth:150,key:"game_ratio",render(t,n){return _[t.game_ratio]&&_[t.game_ratio].label?u(p("n-tag"),{dashed:!0,type:_[t.game_ratio].type,color:_[t.game_ratio].color},{default:()=>[_[t.game_ratio].label]}):u(p("n-tag"),{dashed:!0,color:{color:"rgba(155, 89, 182, 0.1)",borderColor:"rgba(155, 89, 182, 0.3)",textColor:"#9b59b6"}},{default:()=>[o("自定义")]})}},{title:"游戏显示位置",minWidth:150,key:"game_gravity",render(t,n){return u(p("n-tag"),{dashed:!0,type:M[t.game_gravity].color},{default:()=>[M[t.game_gravity].label]})}},{title:"操作",minWidth:100,key:"setting",render(t,n){const D={icon:wu};return u(p("n-button"),{onClick:()=>w(t),size:"small",strong:!0,dashed:!0,type:"info"},{default:()=>[o("管理")],...D})}}]}return(t,n)=>{const D=p("n-alert"),F=p("n-input-group"),a=p("n-card"),e=p("n-data-table");return N(),$(tu,null,[f("main",xu,[f("div",Su,[f("div",Ru,[f("h3",{class:P(`text-base font-semibold leading-7 ${r(s).isDarkMode?"text-white":"text-gray-900"}`)}," 游戏显示布局 ",2),f("p",{class:P(`mt-1 max-w-2xl text-sm leading-6 ${r(s).isDarkMode?"text-gray-300":"text-gray-500"}`)}," 在这里可以快速管理有关游戏显示布局的配置 ",2)])]),u(a,{title:"操作区",size:"small"},{default:l(()=>[f("div",Mu,[u(D,{"show-icon":!0,type:"info"},{default:l(()=>[n[6]||(n[6]=f("p",null,"请添加需要管理的游戏应用到游戏工具箱，Hyper OS 2.0+ 还需要安装修改版的手机/平板管家才会生效。",-1)),r(s).MIOSVersion&&r(s).MIOSVersion>=2?(N(),Cu(r(I),{key:0,strong:"",secondary:"",type:"info",onClick:n[0]||(n[0]=()=>k())},{default:l(()=>n[5]||(n[5]=[o("获取修改版手机/平板管家")])),_:1})):Au("",!0)]),_:1})]),f("div",Ou,[u(r(I),{class:"mb-3 mr-3",type:"success",loading:r(s).loading||r(m).loading,onClick:n[1]||(n[1]=()=>A())},{icon:l(()=>[u(r(W),null,{default:l(()=>[u(r(fu))]),_:1})]),default:l(()=>[n[7]||(n[7]=o(" 刷新游戏列表 "))]),_:1},8,["loading"])]),u(F,null,{default:l(()=>[u(r(Du),{size:"large",clearable:"",value:r(S).searchKeyWord,"onUpdate:value":n[2]||(n[2]=c=>r(S).searchKeyWord=c),ref_key:"searchKeyWordInput",ref:B,placeholder:"搜索游戏名称/游戏包名",autosize:"",style:{width:"80%"}},null,8,["value"]),u(r(I),{size:"large",type:"primary",onClick:n[3]||(n[3]=()=>{var c;(c=B.value)==null||c.blur()})},{icon:l(()=>[u(r(W),null,{default:l(()=>[u(r(_u))]),_:1})]),default:l(()=>[n[8]||(n[8]=o(" 搜索 "))]),_:1}),u(r(I),{size:"large",bordered:"",onClick:n[4]||(n[4]=()=>{r(S).searchKeyWord=""})},{icon:l(()=>[u(r(W),null,{default:l(()=>[u(r(yu))]),_:1})]),default:l(()=>[n[9]||(n[9]=o(" 清空 "))]),_:1})]),_:1})]),_:1}),u(e,{loading:r(s).loading||r(m).loading,columns:r(x),data:r(m).filterGameBoosterList,pagination:d},null,8,["loading","columns","data","pagination"])]),u(Gu,{ref_key:"updateGameBoosterAppDrawer",ref:b,type:"update",title:"更新设置"},null,512)],64)}}});export{Iu as default};
