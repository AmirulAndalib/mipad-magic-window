import{A as H,B as su,C as iu,D as pu,E as du,f as $,k as Y,g as D,F as cu,d as Z,G as Fu,r as A,h as q,H as Eu,q as gu,i as J,j as X,e as d,I as mu,J as vu,K as Bu,t as u,b as l,v as n,l as r,L as j,M as uu,m as eu,p as tu,N as _u,O as Au,P as Cu,Q as fu,n as Q,R as I,S as z,T as Du,U as yu,V as bu,W as Tu,X as W,Y as Ou,Z as Ru,$ as Gu}from"./index-BfRfFGNZ.js";function ku(c,s,p,i){return H(c,function(B,_,E){s(i,p(B),_,E)}),i}function wu(c,s){return function(p,i){return ku(p,c,s(i),{})}}var Iu=Object.prototype,xu=Iu.toString,au=wu(function(c,s,p){s!=null&&typeof s.toString!="function"&&(s=xu.call(s)),c[s]=p},su(iu));function U(c,s){var p={};return s=pu(s),H(c,function(i,B,_){du(p,s(i,B,_),i)}),p}function Su(c,s){return $(),Y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[D("path",{"fill-rule":"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z","clip-rule":"evenodd"})])}const Mu=au({RATIO_FULLSCREEN:"0.0",RATIO_16_TO_9:"1.7777778",RATIO_4_TO_3:"1.3333333",RATIO_21_TO_9:"2.3333333",RATIO_32_TO_9:"3.5555556"}),Nu={RATIO_FULLSCREEN:{type:"info",name:"全屏",color:{}},RATIO_16_TO_9:{type:"error",name:"16:9",color:{}},RATIO_4_TO_3:{type:"success",name:"4:3",color:{}},RATIO_21_TO_9:{type:"warning",name:"21:9",color:{}},RATIO_32_TO_9:{type:"primary",name:"32:9",color:{color:"rgba(255, 105, 180, 0.1)",borderColor:"rgba(255, 105, 180, 0.3)",textColor:"#ff69b4"}}},ou=c=>{console.log(c,"inputArr");const s=cu(c);let p=Object.entries(Mu).map(([i,B])=>{const _=Nu[B];return{label:_.name,value:i,type:_.type,color:_.color}});return s&&(p=[...p,...s]),p},zu=au({GRAVITY_CENTER:17,GRAVITY_TOP:48,GRAVITY_BOTTOM:80}),Uu={GRAVITY_CENTER:{color:"info",name:"居中显示"},GRAVITY_TOP:{color:"success",name:"居顶显示"},GRAVITY_BOTTOM:{color:"error",name:"居底显示"}},nu=()=>Object.entries(zu).map(([c,s])=>{const p=Uu[s];return{label:p.name,value:c,color:p.color}}),Vu=Z({__name:"GameBoosterAppDrawer",props:{type:{},title:{}},emits:["submit"],setup(c,{expose:s,emit:p}){Fu(),A(null),A(null);const i=c,B=A(!1),_=ou([{label:"自定义",value:"custom",type:"primary",color:{color:"rgba(155, 89, 182, 0.1)",borderColor:"rgba(155, 89, 182, 0.3)",textColor:"#9b59b6"}}]),E=U(_,o=>o.value),x=nu(),g=U(x,o=>o.value),S=q();Eu(),gu();const O=J(()=>({theme:S.isDarkMode?eu:tu})),{message:V,modal:R}=X(["message","modal"],{configProviderProps:O});let M,G;const N=A({openDrawer:o=>new Promise((e,C)=>{if(i.type==="update"&&!o){C(new Error("更新模式下必须传入初始化参数")),V.error("初始化参数不能为空");return}i.type==="update"&&(w.value=(o==null?void 0:o.packageName)||"",k.value=(o==null?void 0:o.appName)||"",o!=null&&o.gameGravity&&(y.value=g[o.gameGravity]),o!=null&&o.gameRatio&&(E[o.gameRatio]?(m.value=E[o.gameRatio],f.value=o.gameRatio):(m.value=E.custom,f.value=o.gameRatio))),M=e,G=C,B.value=!0}),closeDrawer:()=>{B.value=!1,G("Drawer closed without submission")}}),k=A(""),w=A(""),y=A(x[0]),m=A(_[0]),f=A(""),t=(o,e)=>{if(e.value==="custom"&&!S.ABTestInfo.GAME_BOOSTER_CUSTOM_RATIO){R.create({title:"无使用权限",type:"warning",preset:"dialog",content:()=>u("div",null,[u("p",null,[n("自定义游戏比例存在使用风险，如果配置了不恰当的自定义游戏比例，可能会触发部分游戏风控导致游戏账号被封！")]),u("p",null,[n("如仍然坚持使用自定义游戏比例，请通过做梦书的酷安动态获取自定义游戏比例的激活口令！(动态内容就有，无需私信，新功能不同口令也不相同)")])])});return}m.value=e,e.value==="custom"?f.value="":f.value=e.value},a=(o,e)=>{y.value=e},b=async()=>{if(!f.value){R.create({title:"游戏显示比例不能为空",type:"error",preset:"dialog",content:()=>u("p",null,[n("噫？游戏显示比例不能为空（敲")])});return}v.value=!0;const o=()=>{v.value=!1,B.value=!1},e=()=>{v.value=!1},C={appName:k.value,packageName:w.value,gameGravity:y.value.value,gameRatio:f.value,loadingCallback:e,closeCallback:o};R.create({title:"确认调整游戏显示布局吗？",type:"warning",preset:"dialog",content:()=>u("p",null,[n("调整后会改变游戏的显示比例，获得更大的游戏视野，但并非所有游戏都兼容游戏显示比例调整，且部分游戏可能会对游戏显示比例的修改作为风控管理，可能导致游戏账号被封禁，调整游戏显示布局前，即认可并了解这些须知。确定要继续吗？")]),positiveText:"确定调整",negativeText:"我再想想",onPositiveClick:async()=>{M(C),e(),o()},onNegativeClick(){e()},onMaskClick(){e()},onClose(){e()}})},v=A(!1);return s({openDrawer:N.value.openDrawer}),(o,e)=>{const C=d("n-input-group-label"),T=d("n-input"),h=d("n-input-group"),L=d("n-button"),P=d("n-dropdown"),K=d("n-card"),lu=d("n-drawer-content"),ru=d("n-drawer");return $(),Y(uu,null,[mu(o.$slots,"default",vu(Bu({openDrawer:N.value.openDrawer}))),u(ru,{show:B.value,"onUpdate:show":e[7]||(e[7]=F=>B.value=F),"default-width":500,placement:"right"},{default:l(()=>[u(lu,{"body-content-class":"auto-ui-drawer-content","scrollbar-props":{trigger:"none"},title:i.title,closable:""},{footer:l(()=>[u(L,{type:"info",loading:v.value,"onUpdate:loading":e[5]||(e[5]=F=>v.value=F),onClick:e[6]||(e[6]=()=>b())},{default:l(()=>e[10]||(e[10]=[n(" 提交 ")])),_:1},8,["loading"])]),default:l(()=>[u(h,null,{default:l(()=>[u(C,{size:"large"},{default:l(()=>e[8]||(e[8]=[n("游戏名称")])),_:1}),u(T,{size:"large",value:k.value,"onUpdate:value":e[0]||(e[0]=F=>k.value=F),readonly:!0,placeholder:"请输入游戏名称"},null,8,["value"])]),_:1}),u(h,{class:"mt-5"},{default:l(()=>[u(C,{size:"large"},{default:l(()=>e[9]||(e[9]=[n("游戏包名")])),_:1}),u(T,{size:"large",value:w.value,"onUpdate:value":e[1]||(e[1]=F=>w.value=F),readonly:!0,placeholder:"请输入游戏包名"},null,8,["value"])]),_:1}),u(K,{bordered:!1,title:"游戏显示比例",size:"small"},{default:l(()=>[u(P,{value:m.value,"onUpdate:value":e[2]||(e[2]=F=>m.value=F),size:"large",trigger:"click",options:r(_),onSelect:t},{default:l(()=>{var F;return[u(L,{block:"",type:m.value.type,color:(F=m.value.color)==null?void 0:F.textColor,dashed:""},{default:l(()=>[n(j(m.value.label),1)]),_:1},8,["type","color"])]}),_:1},8,["value","options"]),u(h,{class:"mt-5"},{default:l(()=>[u(T,{type:"number",ref:"currentCustomGameRatioRef",readonly:m.value.value!=="custom",value:f.value,"onUpdate:value":e[3]||(e[3]=F=>f.value=F),placeholder:"请输入游戏显示比例"},null,8,["readonly","value"])]),_:1})]),_:1}),u(K,{bordered:!1,title:"游戏显示位置",size:"small"},{default:l(()=>[u(P,{value:y.value,"onUpdate:value":e[4]||(e[4]=F=>y.value=F),size:"large",trigger:"click",options:r(x),onSelect:a},{default:l(()=>[u(L,{block:"",type:y.value.color,dashed:""},{default:l(()=>[n(j(y.value.label),1)]),_:1},8,["type"])]),_:1},8,["value","options"])]),_:1})]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),hu={class:"autoui-view mb-10"},Lu={class:"mt-5"},Wu={class:"mb-5 px-4 sm:px-0"},$u={class:"mb-3 flex flex-wrap"},Yu={class:"flex flex-wrap"},Ku=Z({__name:"GameBooster",setup(c){const s=A(null),p=f(),i=q();_u();const B=J(()=>({theme:i.isDarkMode?eu:tu})),{message:_,modal:E,notification:x}=X(["message","modal","notification"],{configProviderProps:B}),g=Au(),S=ou(),O=U(S,t=>t.value),V=nu(),R=U(V,t=>t.value),M=Cu(),G=A(null),N=async()=>{const[t,a]=await W(Ou());a&&E.create({title:"操作失败",type:"error",preset:"dialog",content:()=>u("p",null,[n("发生异常错误，详细错误请查看日志~")])})},k=async()=>{E.create({title:"获取手机/平板管家",type:"info",preset:"dialog",content:()=>u("div",null,[u("p",null,[n("如果规则无法生效，还需要安装修改版的手机/平板管家才会生效~")]),u("p",null,[n("下载地址:https://caiyun.139.com/m/i?135Cdw6hrWd7c")])]),positiveText:"复制下载链接到剪切板",negativeText:"取消",onPositiveClick:()=>{navigator.clipboard.writeText("https://caiyun.139.com/m/i?135Cdw6hrWd7c")},onNegativeClick:()=>{}})},w=async(t,a)=>{if(!i.ABTestInfo.GAME_BOOSTER_RADIO_MANAGER){E.create({title:"内测说明",type:"warning",preset:"dialog",content:()=>u("p",null,[n("该功能尚处于测试阶段，预估最快2024-12-29后正式上线，可能存在较多不稳定性，需要有一定的玩机知识和问题解决能力，如需参与测试请通过做梦书的酷安动态获取新功能内测的激活口令！(动态内容就有，无需私信，新功能不同口令也不相同)")])});return}if(!M.isSupportGameMode.value){E.create({title:"未开启游戏显示布局",type:"error",preset:"dialog",content:()=>u("p",null,[n("未开启游戏显示布局，请先前往模块设置进行开启~")])});return}if(G.value){const[b,v]=await W(G.value.openDrawer({appName:t.app_name,packageName:t.package_name,gameRatio:t.game_ratio,gameGravity:t.game_gravity}));if(b)console.log("操作取消:",b);else if(v){g.loading=!0;const[o,e]=await W(Ru(v.packageName,v.gameRatio,v.gameGravity));o&&(E.create({title:"更新设置失败",type:"error",preset:"dialog",content:()=>u("p",null,[n("发生异常错误，更新失败了QwQ，详细错误请查看错误日志~")])}),g.loading=!1),e&&(g.loading=!1,E.create({title:"更新设置成功",type:"success",preset:"dialog",content:()=>u("p",null,[n("好耶w，已经成功配置")," ",u("span",{class:`font-bold ${i.isDarkMode?"text-teal-400":"text-gray-600"}`},[v.appName])," ",n("的游戏显示布局了OwO~实际生效还需要重启")," ",u("span",{class:`font-bold ${i.isDarkMode?"text-teal-400":"text-gray-600"}`},[v.appName])," ",n("和")," ",u("span",{class:`font-bold ${i.isDarkMode?"text-teal-400":"text-gray-600"}`},[n("平板/手机管家")])," ",n("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){Gu(t.package_name).then(async C=>{await g.initDefault(),E.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>u("p",null,[n("已经成功为你重启对应的作用域，请查看是否生效~")])})}).catch(C=>{E.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>u("p",null,[n("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}))}}},y=async()=>{await g.initDefault()},m=fu({page:1,pageSize:10,showSizePicker:!0,onChange:t=>{m.page=t},onUpdatePageSize:t=>{m.pageSize=t,m.page=1}});function f(){return[{title:"游戏名称",minWidth:250,key:"name",render(t,a){return u("div",null,[t.app_name&&u("p",null,[t.app_name]),t.app_name&&u("p",null,[u("span",{class:{hidden:!t.app_name}},[n("(")]),t.package_name,u("span",{class:{hidden:!t.app_name}},[n(")")])])])}},{title:"游戏显示比例",minWidth:150,key:"game_ratio",render(t,a){return O[t.game_ratio]&&O[t.game_ratio].label?u(d("n-tag"),{dashed:!0,type:O[t.game_ratio].type,color:O[t.game_ratio].color},{default:()=>[O[t.game_ratio].label]}):u(d("n-tag"),{dashed:!0,color:{color:"rgba(155, 89, 182, 0.1)",borderColor:"rgba(155, 89, 182, 0.3)",textColor:"#9b59b6"}},{default:()=>[n("自定义")]})}},{title:"游戏显示位置",minWidth:150,key:"game_gravity",render(t,a){return u(d("n-tag"),{dashed:!0,type:R[t.game_gravity].color},{default:()=>[R[t.game_gravity].label]})}},{title:"操作",minWidth:100,key:"setting",render(t,a){const b={icon:Su};return u(d("n-button"),{onClick:()=>w(t),size:"small",strong:!0,dashed:!0,type:"info"},{default:()=>[n("管理")],...b})}}]}return(t,a)=>{const b=d("n-alert"),v=d("PlusIcon"),o=d("n-input-group"),e=d("n-card"),C=d("n-data-table");return $(),Y(uu,null,[D("main",hu,[D("div",Lu,[D("div",Wu,[D("h3",{class:Q(`text-base font-semibold leading-7 ${r(i).isDarkMode?"text-white":"text-gray-900"}`)}," 游戏显示布局 ",2),D("p",{class:Q(`mt-1 max-w-2xl text-sm leading-6 ${r(i).isDarkMode?"text-gray-300":"text-gray-500"}`)}," 在这里可以快速管理有关游戏显示布局的配置 ",2)])]),u(e,{title:"操作区",size:"small"},{default:l(()=>[D("div",$u,[u(b,{"show-icon":!0,type:"info"},{default:l(()=>[a[7]||(a[7]=D("p",null,"请添加需要管理的游戏应用到游戏工具箱，Hyper OS 2.0+还需要安装修改版的手机/平板管家才会生效。",-1)),a[8]||(a[8]=D("p",null,"修改版的手机/平板管家支持Hyper OS 2.0/1.0和MIUI 14:",-1)),u(r(I),{strong:"",secondary:"",type:"info",onClick:a[0]||(a[0]=()=>k())},{default:l(()=>a[6]||(a[6]=[n("获取修改版手机/平板管家")])),_:1})]),_:1})]),D("div",Yu,[u(r(I),{class:"mb-3 mr-3",type:"info",loading:r(i).loading||r(g).loading,onClick:a[1]||(a[1]=()=>N())},{icon:l(()=>[u(r(z),null,{default:l(()=>[u(v)]),_:1})]),default:l(()=>[a[9]||(a[9]=n(" 添加游戏 "))]),_:1},8,["loading"]),u(r(I),{class:"mb-3 mr-3",type:"success",loading:r(i).loading||r(g).loading,onClick:a[2]||(a[2]=()=>y())},{icon:l(()=>[u(r(z),null,{default:l(()=>[u(r(Du))]),_:1})]),default:l(()=>[a[10]||(a[10]=n(" 刷新游戏列表 "))]),_:1},8,["loading"])]),u(o,null,{default:l(()=>[u(r(yu),{size:"large",clearable:"",value:r(g).searchKeyWord,"onUpdate:value":a[3]||(a[3]=T=>r(g).searchKeyWord=T),ref_key:"searchKeyWordInput",ref:s,placeholder:"搜索游戏名称/游戏包名",autosize:"",style:{width:"80%"}},null,8,["value"]),u(r(I),{size:"large",type:"primary",onClick:a[4]||(a[4]=()=>{var T;(T=s.value)==null||T.blur()})},{icon:l(()=>[u(r(z),null,{default:l(()=>[u(r(bu))]),_:1})]),default:l(()=>[a[11]||(a[11]=n(" 搜索 "))]),_:1}),u(r(I),{size:"large",bordered:"",onClick:a[5]||(a[5]=()=>{r(g).searchKeyWord=""})},{icon:l(()=>[u(r(z),null,{default:l(()=>[u(r(Tu))]),_:1})]),default:l(()=>[a[12]||(a[12]=n(" 清空 "))]),_:1})]),_:1})]),_:1}),u(C,{loading:r(i).loading||r(g).loading,columns:r(p),data:r(g).filterGameBoosterList,pagination:m},null,8,["loading","columns","data","pagination"])]),u(Vu,{ref_key:"updateGameBoosterAppDrawer",ref:G,type:"update",title:"更新设置"},null,512)],64)}}});export{Ku as default};
