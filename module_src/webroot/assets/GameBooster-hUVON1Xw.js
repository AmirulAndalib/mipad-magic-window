import{A as H,B as se,C as ie,D as pe,E as ce,f as W,k as Y,g as f,F as de,d as Z,G as Fe,r as B,h as q,H as Ee,q as ge,i as J,j as X,e as F,I as me,J as ve,K as _e,t as e,b as l,v as n,l as s,L as P,M as ee,m as ue,p as te,N as Be,O as Ae,P as Ce,Q as fe,n as j,R as M,S as L,T as De,U as ye,V as be,W as Te,X as Q,Y as Oe,Z as Re}from"./index-ePHY5OqT.js";function Ge(c,r,p,i){return H(c,function(E,v,g){r(i,p(E),v,g)}),i}function ke(c,r){return function(p,i){return Ge(p,c,r(i),{})}}var we=Object.prototype,Ie=we.toString,ae=ke(function(c,r,p){r!=null&&typeof r.toString!="function"&&(r=Ie.call(r)),c[r]=p},se(ie));function N(c,r){var p={};return r=pe(r),H(c,function(i,E,v){ce(p,r(i,E,v),i)}),p}function xe(c,r){return W(),Y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[f("path",{"fill-rule":"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 0 0-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 0 0-2.282.819l-.922 1.597a1.875 1.875 0 0 0 .432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 0 0 0 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 0 0-.432 2.385l.922 1.597a1.875 1.875 0 0 0 2.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 0 0 2.28-.819l.923-1.597a1.875 1.875 0 0 0-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 0 0 0-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 0 0-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 0 0-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 0 0-1.85-1.567h-1.843ZM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5Z","clip-rule":"evenodd"})])}const Se=ae({RATIO_FULLSCREEN:"0.0",RATIO_16_TO_9:"1.7777778",RATIO_4_TO_3:"1.3333333",RATIO_21_TO_9:"2.3333333",RATIO_32_TO_9:"3.5555556"}),Me={RATIO_FULLSCREEN:{type:"info",name:"全屏",color:{}},RATIO_16_TO_9:{type:"error",name:"16:9",color:{}},RATIO_4_TO_3:{type:"success",name:"4:3",color:{}},RATIO_21_TO_9:{type:"warning",name:"21:9",color:{}},RATIO_32_TO_9:{type:"primary",name:"32:9",color:{color:"rgba(255, 105, 180, 0.1)",borderColor:"rgba(255, 105, 180, 0.3)",textColor:"#ff69b4"}}},oe=c=>{console.log(c,"inputArr");const r=de(c);let p=Object.entries(Se).map(([i,E])=>{const v=Me[E];return{label:v.name,value:i,type:v.type,color:v.color}});return r&&(p=[...p,...r]),p},Ne=ae({GRAVITY_CENTER:17,GRAVITY_TOP:48,GRAVITY_BOTTOM:80}),ze={GRAVITY_CENTER:{color:"info",name:"居中显示"},GRAVITY_TOP:{color:"success",name:"居顶显示"},GRAVITY_BOTTOM:{color:"error",name:"居底显示"}},ne=()=>Object.entries(Ne).map(([c,r])=>{const p=ze[r];return{label:p.name,value:c,color:p.color}}),he=Z({__name:"GameBoosterAppDrawer",props:{type:{},title:{}},emits:["submit"],setup(c,{expose:r,emit:p}){Fe(),B(null),B(null);const i=c,E=B(!1),v=oe([{label:"自定义",value:"custom",type:"primary",color:{color:"rgba(155, 89, 182, 0.1)",borderColor:"rgba(155, 89, 182, 0.3)",textColor:"#9b59b6"}}]),g=N(v,a=>a.value),w=ne(),m=N(w,a=>a.value),I=q();Ee(),ge();const b=J(()=>({theme:I.isDarkMode?ue:te})),{message:z,modal:O}=X(["message","modal"],{configProviderProps:b});let x,R;const S=B({openDrawer:a=>new Promise((u,T)=>{if(i.type==="update"&&!a){T(new Error("更新模式下必须传入初始化参数")),z.error("初始化参数不能为空");return}i.type==="update"&&(k.value=(a==null?void 0:a.packageName)||"",G.value=(a==null?void 0:a.appName)||"",a!=null&&a.gameGravity&&(_.value=m[a.gameGravity]),a!=null&&a.gameRatio&&(g[a.gameRatio]?(A.value=g[a.gameRatio],t.value=a.gameRatio):(A.value=g.custom,t.value=a.gameRatio))),x=u,R=T,E.value=!0}),closeDrawer:()=>{E.value=!1,R("Drawer closed without submission")}}),G=B(""),k=B(""),_=B(w[0]),A=B(v[0]),t=B(""),o=(a,u)=>{if(u.value==="custom"&&!I.ABTestInfo.GAME_BOOSTER_CUSTOM_RATIO){O.create({title:"无使用权限",type:"warning",preset:"dialog",content:()=>e("div",null,[e("p",null,[n("自定义游戏比例存在使用风险，如果配置了不恰当的自定义游戏比例，可能会触发部分游戏风控导致游戏账号被封！")]),e("p",null,[n("如仍然坚持使用自定义游戏比例，请通过做梦书的酷安动态获取自定义游戏比例的激活口令！(动态内容就有，无需私信，新功能不同口令也不相同)")])])});return}A.value=u,u.value==="custom"?t.value="":t.value=u.value},y=(a,u)=>{_.value=u},C=async()=>{if(!t.value){O.create({title:"游戏显示比例不能为空",type:"error",preset:"dialog",content:()=>e("p",null,[n("噫？游戏显示比例不能为空（敲")])});return}D.value=!0;const a=()=>{D.value=!1,E.value=!1},u=()=>{D.value=!1},T={appName:G.value,packageName:k.value,gameGravity:_.value.value,gameRatio:t.value,loadingCallback:u,closeCallback:a};O.create({title:"确认调整游戏显示布局吗？",type:"warning",preset:"dialog",content:()=>e("p",null,[n("调整后会改变游戏的显示比例，获得更大的游戏视野，但并非所有游戏都兼容游戏显示比例调整，且部分游戏可能会对游戏显示比例的修改作为风控管理，可能导致游戏账号被封禁，调整游戏显示布局前，即认可并了解这些须知。确定要继续吗？")]),positiveText:"确定调整",negativeText:"我再想想",onPositiveClick:async()=>{x(T),u(),a()},onNegativeClick(){u()},onMaskClick(){u()},onClose(){u()}})},D=B(!1);return r({openDrawer:S.value.openDrawer}),(a,u)=>{const T=F("n-input-group-label"),h=F("n-input"),U=F("n-input-group"),V=F("n-button"),$=F("n-dropdown"),K=F("n-card"),le=F("n-drawer-content"),re=F("n-drawer");return W(),Y(ee,null,[me(a.$slots,"default",ve(_e({openDrawer:S.value.openDrawer}))),e(re,{show:E.value,"onUpdate:show":u[7]||(u[7]=d=>E.value=d),"default-width":500,placement:"right"},{default:l(()=>[e(le,{"body-content-class":"auto-ui-drawer-content","scrollbar-props":{trigger:"none"},title:i.title,closable:""},{footer:l(()=>[e(V,{type:"info",loading:D.value,"onUpdate:loading":u[5]||(u[5]=d=>D.value=d),onClick:u[6]||(u[6]=()=>C())},{default:l(()=>u[10]||(u[10]=[n(" 提交 ")])),_:1},8,["loading"])]),default:l(()=>[e(U,null,{default:l(()=>[e(T,{size:"large"},{default:l(()=>u[8]||(u[8]=[n("游戏名称")])),_:1}),e(h,{size:"large",value:G.value,"onUpdate:value":u[0]||(u[0]=d=>G.value=d),readonly:!0,placeholder:"请输入游戏名称"},null,8,["value"])]),_:1}),e(U,{class:"mt-5"},{default:l(()=>[e(T,{size:"large"},{default:l(()=>u[9]||(u[9]=[n("游戏包名")])),_:1}),e(h,{size:"large",value:k.value,"onUpdate:value":u[1]||(u[1]=d=>k.value=d),readonly:!0,placeholder:"请输入游戏包名"},null,8,["value"])]),_:1}),e(K,{bordered:!1,title:"游戏显示比例",size:"small"},{default:l(()=>[e($,{value:A.value,"onUpdate:value":u[2]||(u[2]=d=>A.value=d),size:"large",trigger:"click",options:s(v),onSelect:o},{default:l(()=>{var d;return[e(V,{block:"",type:A.value.type,color:(d=A.value.color)==null?void 0:d.textColor,dashed:""},{default:l(()=>[n(P(A.value.label),1)]),_:1},8,["type","color"])]}),_:1},8,["value","options"]),e(U,{class:"mt-5"},{default:l(()=>[e(h,{type:"number",ref:"currentCustomGameRatioRef",readonly:A.value.value!=="custom",value:t.value,"onUpdate:value":u[3]||(u[3]=d=>t.value=d),placeholder:"请输入游戏显示比例"},null,8,["readonly","value"])]),_:1})]),_:1}),e(K,{bordered:!1,title:"游戏显示位置",size:"small"},{default:l(()=>[e($,{value:_.value,"onUpdate:value":u[4]||(u[4]=d=>_.value=d),size:"large",trigger:"click",options:s(w),onSelect:y},{default:l(()=>[e(V,{block:"",type:_.value.color,dashed:""},{default:l(()=>[n(P(_.value.label),1)]),_:1},8,["type"])]),_:1},8,["value","options"])]),_:1})]),_:1},8,["title"])]),_:1},8,["show"])],64)}}}),Ue={class:"autoui-view mb-10"},Ve={class:"mt-5"},Le={class:"mb-5 px-4 sm:px-0"},We={class:"mb-3 flex flex-wrap"},Ye={class:"flex flex-wrap"},Ke=Z({__name:"GameBooster",setup(c){const r=B(null),p=A(),i=q();Be();const E=J(()=>({theme:i.isDarkMode?ue:te})),{message:v,modal:g,notification:w}=X(["message","modal","notification"],{configProviderProps:E}),m=Ae(),I=oe(),b=N(I,t=>t.value),z=ne(),O=N(z,t=>t.value),x=Ce(),R=B(null),S=async()=>{g.create({title:"获取手机/平板管家",type:"info",preset:"dialog",content:()=>e("div",null,[e("p",null,[n("如果规则无法生效，还需要安装修改版的手机/平板管家才会生效~")]),e("p",null,[n("下载地址:https://caiyun.139.com/m/i?135Cdw6hrWd7c")])]),positiveText:"复制下载链接到剪切板",negativeText:"取消",onPositiveClick:()=>{navigator.clipboard.writeText("https://caiyun.139.com/m/i?135Cdw6hrWd7c")},onNegativeClick:()=>{}})},G=async(t,o)=>{if(!i.ABTestInfo.GAME_BOOSTER_RADIO_MANAGER){g.create({title:"内测说明",type:"warning",preset:"dialog",content:()=>e("p",null,[n("该功能尚处于测试阶段，预估最快2024-12-29后正式上线，可能存在较多不稳定性，需要有一定的玩机知识和问题解决能力，如需参与测试请通过做梦书的酷安动态获取新功能内测的激活口令！(动态内容就有，无需私信，新功能不同口令也不相同)")])});return}if(!x.isSupportGameMode.value){g.create({title:"未开启游戏显示布局",type:"error",preset:"dialog",content:()=>e("p",null,[n("未开启游戏显示布局，请先前往模块设置进行开启~")])});return}if(R.value){const[y,C]=await Q(R.value.openDrawer({appName:t.app_name,packageName:t.package_name,gameRatio:t.game_ratio,gameGravity:t.game_gravity}));if(y)console.log("操作取消:",y);else if(C){m.loading=!0;const[D,a]=await Q(Oe(C.packageName,C.gameRatio,C.gameGravity));D&&(g.create({title:"更新设置失败",type:"error",preset:"dialog",content:()=>e("p",null,[n("发生异常错误，更新失败了QwQ，详细错误请查看错误日志~")])}),m.loading=!1),a&&(m.loading=!1,g.create({title:"更新设置成功",type:"success",preset:"dialog",content:()=>e("p",null,[n("好耶w，已经成功配置")," ",e("span",{class:`font-bold ${i.isDarkMode?"text-teal-400":"text-gray-600"}`},[C.appName])," ",n("的游戏显示布局了OwO~实际生效还需要重启")," ",e("span",{class:`font-bold ${i.isDarkMode?"text-teal-400":"text-gray-600"}`},[C.appName])," ",n("和")," ",e("span",{class:`font-bold ${i.isDarkMode?"text-teal-400":"text-gray-600"}`},[n("平板/手机管家")])," ",n("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){Re(t.package_name).then(async u=>{await m.initDefault(),g.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>e("p",null,[n("已经成功为你重启对应的作用域，请查看是否生效~")])})}).catch(u=>{g.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>e("p",null,[n("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})})}}))}}},k=async()=>{await m.initDefault()},_=fe({page:1,pageSize:10,showSizePicker:!0,onChange:t=>{_.page=t},onUpdatePageSize:t=>{_.pageSize=t,_.page=1}});function A(){return[{title:"游戏名称",minWidth:250,key:"name",render(t,o){return e("div",null,[t.app_name&&e("p",null,[t.app_name]),t.app_name&&e("p",null,[e("span",{class:{hidden:!t.app_name}},[n("(")]),t.package_name,e("span",{class:{hidden:!t.app_name}},[n(")")])])])}},{title:"游戏显示比例",minWidth:150,key:"game_ratio",render(t,o){return b[t.game_ratio]&&b[t.game_ratio].label?e(F("n-tag"),{dashed:!0,type:b[t.game_ratio].type,color:b[t.game_ratio].color},{default:()=>[b[t.game_ratio].label]}):e(F("n-tag"),{dashed:!0,color:{color:"rgba(155, 89, 182, 0.1)",borderColor:"rgba(155, 89, 182, 0.3)",textColor:"#9b59b6"}},{default:()=>[n("自定义")]})}},{title:"游戏显示位置",minWidth:150,key:"game_gravity",render(t,o){return e(F("n-tag"),{dashed:!0,type:O[t.game_gravity].color},{default:()=>[O[t.game_gravity].label]})}},{title:"操作",minWidth:100,key:"setting",render(t,o){const y={icon:xe};return e(F("n-button"),{onClick:()=>G(t),size:"small",strong:!0,dashed:!0,type:"info"},{default:()=>[n("管理")],...y})}}]}return(t,o)=>{const y=F("n-alert"),C=F("n-input-group"),D=F("n-card"),a=F("n-data-table");return W(),Y(ee,null,[f("main",Ue,[f("div",Ve,[f("div",Le,[f("h3",{class:j(`text-base font-semibold leading-7 ${s(i).isDarkMode?"text-white":"text-gray-900"}`)}," 游戏显示布局 ",2),f("p",{class:j(`mt-1 max-w-2xl text-sm leading-6 ${s(i).isDarkMode?"text-gray-300":"text-gray-500"}`)}," 在这里可以快速管理有关游戏显示布局的配置 ",2)])]),e(D,{title:"操作区",size:"small"},{default:l(()=>[f("div",We,[e(y,{"show-icon":!0,type:"info"},{default:l(()=>[o[6]||(o[6]=f("p",null,"请添加需要管理的游戏应用到游戏工具箱，Hyper OS 2.0+还需要安装修改版的手机/平板管家才会生效。",-1)),o[7]||(o[7]=f("p",null,"修改版的手机/平板管家支持Hyper OS 2.0/1.0和MIUI 14:",-1)),e(s(M),{strong:"",secondary:"",type:"info",onClick:o[0]||(o[0]=()=>S())},{default:l(()=>o[5]||(o[5]=[n("获取修改版手机/平板管家")])),_:1})]),_:1})]),f("div",Ye,[e(s(M),{class:"mb-3 mr-3",type:"success",loading:s(i).loading||s(m).loading,onClick:o[1]||(o[1]=()=>k())},{icon:l(()=>[e(s(L),null,{default:l(()=>[e(s(De))]),_:1})]),default:l(()=>[o[8]||(o[8]=n(" 刷新游戏列表 "))]),_:1},8,["loading"])]),e(C,null,{default:l(()=>[e(s(ye),{size:"large",clearable:"",value:s(m).searchKeyWord,"onUpdate:value":o[2]||(o[2]=u=>s(m).searchKeyWord=u),ref_key:"searchKeyWordInput",ref:r,placeholder:"搜索游戏名称/游戏包名",autosize:"",style:{width:"80%"}},null,8,["value"]),e(s(M),{size:"large",type:"primary",onClick:o[3]||(o[3]=()=>{var u;(u=r.value)==null||u.blur()})},{icon:l(()=>[e(s(L),null,{default:l(()=>[e(s(be))]),_:1})]),default:l(()=>[o[9]||(o[9]=n(" 搜索 "))]),_:1}),e(s(M),{size:"large",bordered:"",onClick:o[4]||(o[4]=()=>{s(m).searchKeyWord=""})},{icon:l(()=>[e(s(L),null,{default:l(()=>[e(s(Te))]),_:1})]),default:l(()=>[o[10]||(o[10]=n(" 清空 "))]),_:1})]),_:1})]),_:1}),e(a,{loading:s(i).loading||s(m).loading,columns:s(p),data:s(m).filterGameBoosterList,pagination:_},null,8,["loading","columns","data","pagination"])]),e(he,{ref_key:"updateGameBoosterAppDrawer",ref:R,type:"update",title:"更新设置"},null,512)],64)}}});export{Ke as default};
